---
- name: define kms listen address
  set_fact:
    priv_validator_laddr: "tcp://127.0.0.1:26659"
    priv_validator_raddr: "tcp://127.0.0.1:26659"
  when: kms is defined and kms == 'tmkms'

- name: base
  import_tasks: base.yml

- name: config
  import_tasks: config.yml

- name: faucet
  import_tasks: faucet.yml
  when: faucet_enabled

- name: install rust
  include_role: 
    name: rust_install
  when: kms is defined and kms == 'tmkms'

- name: kms
  import_tasks: tmkms.yml
  when: kms is defined and kms == 'tmkms'

- name: join
  import_tasks: join.yml
  when: genesis_file is defined or genesis_url is defined

- name: setup systemd services
  import_tasks: services.yml

- name: setup APIs
  import_tasks: apis.yml

- name: setup monitoring
  import_tasks: monitoring.yml

- name: Rebooting the machine
  include_role:
    name: reboot
  when: reboot | default(false) | bool
  tags:
    - reboot
